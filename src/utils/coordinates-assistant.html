<!DOCTYPE html>
<html>
<head>
    <title>Position Mapper</title>
    <style>
        body { 
            padding: 20px; 
            font-family: Arial, sans-serif; 
        }
        .container { 
            display: flex; 
            flex-direction: column; 
            gap: 20px; 
        }
        .image-container { 
            position: relative; 
            display: inline-block; 
            margin-top: 20px; 
        }
        .point {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: red;
            border-radius: 50%;
            border: 2px solid white;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }
        #coordinates {
            font-family: monospace;
            white-space: pre;
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            margin-top: 20px;
        }
        #imagePreview {
            max-width: 100%;
            max-height: 80vh;
            display: none;
        }
        .controls { 
            margin-top: 10px; 
        }
        button { 
            margin-right: 10px; 
            padding: 5px 10px; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div>
            <input type="file" id="fileInput" accept="image/*">
            <div class="image-container">
                <img id="imagePreview">
                <div id="points"></div>
            </div>
            <div class="controls">
                <button id="clearPoints">Clear Points</button>
                <button id="copyToClipboard">Copy Coordinates</button>
            </div>
        </div>
        <div>
            <h3>Normalized Coordinates:</h3>
            <div id="coordinates"></div>
        </div>
    </div>

    <script>
        var fileInput = document.getElementById('fileInput');
        var imagePreview = document.getElementById('imagePreview');
        var pointsContainer = document.getElementById('points');
        var coordinates = document.getElementById('coordinates');
        var clearButton = document.getElementById('clearPoints');
        var copyButton = document.getElementById('copyToClipboard');
        var points = [];

        fileInput.onchange = function(e) {
            var file = e.target.files[0];
            if (!file) return;

            var reader = new FileReader();
            reader.onload = function(e) {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                points = [];
                updateDisplay();
            };
            reader.readAsDataURL(file);
        };

        imagePreview.onclick = function(e) {
            var rect = imagePreview.getBoundingClientRect();
            var x = (e.clientX - rect.left) / rect.width;
            var y = (e.clientY - rect.top) / rect.height;
            
            points.push({
                x: Number(x.toFixed(3)), 
                y: Number(y.toFixed(3))
            });
            updateDisplay();
        };

        clearButton.onclick = function() {
            points = [];
            updateDisplay();
        };

        copyButton.onclick = function() {
            var coordsText = coordinates.textContent;
            navigator.clipboard.writeText(coordsText);
            alert('Coordinates copied to clipboard!');
        };

        function updateDisplay() {
            var pointsHtml = '';
            for (var i = 0; i < points.length; i++) {
                var point = points[i];
                pointsHtml += '<div class="point" style="left: ' + 
                    (point.x * 100) + '%; top: ' + 
                    (point.y * 100) + '%"></div>';
            }
            pointsContainer.innerHTML = pointsHtml;

            var coordsText = '[\n';
            for (var i = 0; i < points.length; i++) {
                var point = points[i];
                coordsText += '    {x: ' + point.x + ', y: ' + point.y + '}';
                if (i < points.length - 1) {
                    coordsText += ',';
                }
                coordsText += '\n';
            }
            coordsText += ']';
            coordinates.textContent = coordsText;
        }
    </script>
</body>
</html>